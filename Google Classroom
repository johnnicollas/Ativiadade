-- Criação do banco de dados
CREATE DATABASE db_inscricao_financeiro;
USE db_inscricao_financeiro;

-- Criação das tabelas

-- 1. Tabela ADMINS (Administradores)
CREATE TABLE admins (
    id INT NOT NULL AUTO_INCREMENT,
    usuario VARCHAR(100) NOT NULL UNIQUE,
    senha VARCHAR(255) NOT NULL,
    nome VARCHAR(255),
    email VARCHAR(255) UNIQUE,
    ativo TINYINT(1) NOT NULL DEFAULT 1, -- Definição de valor padrão e NOT NULL
    data_criacao TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,
    ultimo_acesso TIMESTAMP,
    CONSTRAINT PK_ADMINS PRIMARY KEY (id) -- Definição de restrição nomeada
);

-- 2. Tabela INSCRICOES (Inscrições)
CREATE TABLE inscricoes (
    id INT NOT NULL AUTO_INCREMENT,
    nome VARCHAR(255) NOT NULL,
    nascimento DATE,
    cpf VARCHAR(11) NOT NULL UNIQUE,
    email VARCHAR(255) UNIQUE,
    telefone VARCHAR(20),
    curso VARCHAR(100) NOT NULL,
    turno VARCHAR(50),
    modalidade VARCHAR(50),
    motivo TEXT,
    status VARCHAR(50) NOT NULL DEFAULT 'PENDENTE', -- Definição de valor padrão
    data_inscricao TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,
    data_atualizacao TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
    CONSTRAINT PK_INSCRICAO PRIMARY KEY (id) -- Definição de restrição nomeada
);

-- 3. Tabela MENSALIDADES (Registros Financeiros)
CREATE TABLE mensalidades (
    id INT NOT NULL AUTO_INCREMENT,
    inscricao_id INT NOT NULL,
    valor DECIMAL(10, 2) NOT NULL,
    desconto_percentual DECIMAL(5, 2) NOT NULL DEFAULT 0.00,
    valor_com_desconto DECIMAL(10, 2) NOT NULL,
    data_pagamento DATE,
    pago TINYINT(1) NOT NULL DEFAULT 0, -- Definição de valor padrão
    meses_totais INT NOT NULL,
    meses_restantes INT NOT NULL,
    proxima_cobranca DATE,
    observacoes TEXT,
    data_criacao TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,
    data_atualizacao TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
    CONSTRAINT PK_MENSALIDADE PRIMARY KEY (id), -- Definição de restrição nomeada
    CONSTRAINT FK_MENSALIDADE_INSCRICAO FOREIGN KEY (inscricao_id) REFERENCES inscricoes(id)
);
